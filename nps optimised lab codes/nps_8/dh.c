#include<stdio.h>
#include<stdlib.h>
#include<math.h>

int main()
{

    //------------------------------------------------------------------------------------------------
    //  > Take the value of q and alpha
    //------------------------------------------------------------------------------------------------
        int q;
        int alpha;

        printf("Enter the value of modulus and its prime factor: ");
        scanf("%d", &q);
        scanf("%d", &alpha);
    //------------------------------------------------------------------------------------------------
    //  > Take the private key of A abd B
    //------------------------------------------------------------------------------------------------
        int XA;
        int XB;

        printf("Enter the private key of A : ");
        scanf("%d", &XA);

        printf("Enter the private key of B : ");
        scanf("%d", &XB);
    //------------------------------------------------------------------------------------------------
    //  > Compute the public key of A and B:
    //------------------------------------------------------------------------------------------------
        int YA = (int)pow(alpha, XA) % q;
        int YB = (int)pow(alpha, XB) % q;
    //------------------------------------------------------------------------------------------------
    //  > Secret key of A and B
    //------------------------------------------------------------------------------------------------
        int SA = (int)pow(YB, XA) % q;
        int SB = (int)pow(YA, XB) % q;
    //------------------------------------------------------------------------------------------------
    //  > Results:
    //------------------------------------------------------------------------------------------------
        printf("Public key of A = %d\n", YA);
        printf("Public key of B = %d\n", YB);
    //------------------------------------------------------------------------------------------------
        printf("Secret key of A = %d\n", SA);
        printf("Secret key of B = %d\n", SB);
    //------------------------------------------------------------------------------------------------
}